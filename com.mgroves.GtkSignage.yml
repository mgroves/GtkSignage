app-id: com.mgroves.GtkSignage

runtime: org.gnome.Platform
runtime-version: '46'
sdk: org.gnome.Sdk

command: gtk-signage

finish-args:
  - --share=network
  - --socket=x11
  - --socket=wayland
  - --device=dri
  - --filesystem=home

env:
  PYTHONPATH: /app/lib/python3.12/site-packages:/app/lib/gtk-signage

modules:
  - name: python-deps
    buildsystem: simple
    build-options:
      build-args:
        - --share=network
    build-commands:
      - pip3 install --no-cache-dir --prefix=/app -r requirements.txt
    sources:
      - type: file
        path: requirements.txt

  - name: gtk-signage
    buildsystem: simple
    build-commands:
      - mkdir -p /app/lib/gtk-signage
      - cp -r signage /app/lib/gtk-signage/
      - install -D main.py /app/lib/gtk-signage/main.py
      - install -D gtk-signage.sh /app/bin/gtk-signage
      - chmod +x /app/bin/gtk-signage
    sources:
      - type: dir
        path: .